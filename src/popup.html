<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Favicon Preview Settings</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body class="font-mono bg-gradient-to-br from-dark to-dark-100 text-text-secondary min-w-[300px]">
    <div class="p-5 font-mono">
      <h1 class="text-lg font-medium mb-4 text-text-primary text-center tracking-tight">Favicon Preview</h1>

      <!-- Tab Navigation -->
      <div class="tab-nav">
        <button class="tab-btn active" data-tab="settings">Settings</button>
        <button class="tab-btn" data-tab="editor">Editor</button>
      </div>

      <!-- Settings Tab -->
      <div class="tab-content active" id="settingsTab">

      <!-- Live Preview Section -->
      <div class="bg-white/[0.02] rounded-xl p-5 mb-4 border border-border-subtle" id="livePreviewSection">
        <div class="flex flex-col gap-4">
          <div class="flex items-center justify-center gap-6">
            <div class="flex flex-col items-center gap-2">
              <div class="w-16 h-16 rounded-xl border border-border-light bg-surface-dark flex items-center justify-center p-1.5 shadow-inset">
                <img id="livePreviewImage" alt="Live preview" class="w-full h-full rounded-lg object-contain hidden" />
                <div class="flex flex-col items-center justify-center gap-1.5" id="livePreviewEmpty">
                  <svg class="w-5 h-5 stroke-text-subtle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                    <circle cx="8.5" cy="8.5" r="1.5" />
                    <path d="M21 15l-5-5L5 21" />
                  </svg>
                  <span class="text-2xs text-text-subtle text-center leading-tight">Hover<br/>image</span>
                </div>
                <div class="hidden flex-col items-center justify-center gap-2 w-full h-full" id="livePreviewLoading">
                  <div class="spinner-circle animate-rotate"></div>
                  <span class="text-2xs text-text-subtle text-center leading-tight">Loading...</span>
                </div>
              </div>
              <span class="text-[9px] text-text-subtle uppercase tracking-wide">Preview</span>
            </div>
            <div class="flex flex-col items-center gap-1">
              <div class="w-6 h-6 rounded-full bg-white/[0.03] border border-border-light flex items-center justify-center">
                <span class="text-[10px] text-text-subtle font-bold">VS</span>
              </div>
            </div>
            <div class="flex flex-col items-center gap-2">
              <div class="w-16 h-16 rounded-xl border border-border-light bg-surface-dark flex items-center justify-center p-1.5 shadow-inset">
                <img id="originalFaviconImage" alt="Original favicon" class="w-full h-full rounded-lg object-contain" />
              </div>
              <span class="text-[9px] text-text-subtle uppercase tracking-wide">Original</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Compact Toggles -->
      <div class="bg-white/[0.02] rounded-lg p-2.5 border border-border-subtle backdrop-blur-xs">
        <!-- Global Toggle -->
        <div class="flex items-center justify-between py-1.5 px-1 mb-2 pb-2.5 border-b border-white/[0.05]" id="globalToggle">
          <div class="flex items-center gap-2">
            <svg class="w-3.5 h-3.5 stroke-text-subtle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18.36 6.64a9 9 0 1 1-12.73 0" />
              <line x1="12" y1="2" x2="12" y2="12" />
            </svg>
            <span class="text-xs text-text-secondary font-medium">Extension</span>
            <span class="text-xs text-accent-green font-medium" id="globalToggleStatus">Active</span>
          </div>
          <button class="toggle-switch" id="powerBtn" title="Toggle extension on/off">
            <span class="toggle-slider"></span>
          </button>
        </div>

        <!-- Site Toggle -->
        <div class="flex items-center justify-between py-1.5 px-1" id="siteToggle">
          <div class="flex items-center gap-2 flex-1 min-w-0">
            <svg class="w-3.5 h-3.5 stroke-text-subtle flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z" />
            </svg>
            <span class="text-xs text-text-secondary font-medium flex-shrink-0">Site</span>
            <span class="text-xs text-text-primary truncate" id="siteName">-</span>
          </div>
          <button class="toggle-switch" id="toggleBtn" title="Toggle tracking for this site">
            <span class="toggle-slider"></span>
          </button>
        </div>
      </div>

      <div class="h-px bg-gradient-to-r from-transparent via-white/[0.08] to-transparent my-5"></div>

      <!-- Download Section -->
      <div class="mt-2">
        <div class="flex items-center justify-between mb-2.5">
          <label class="text-sm font-medium text-text-subtle uppercase tracking-wider">Image to Download</label>
        </div>
        <div class="flex items-center gap-3.5 bg-white/[0.02] rounded-lg p-3.5 mb-3 border border-border-subtle backdrop-blur-xs">
          <div class="w-13 h-13 bg-surface-dark rounded-lg flex items-center justify-center overflow-hidden relative border border-border-light shadow-inset" id="faviconPreview">
            <img id="faviconImage" alt="Current favicon" class="max-w-full max-h-full object-contain hidden" />
            <div class="flex flex-col items-center justify-center gap-2 absolute" id="faviconLoading">
              <div class="spinner-circle animate-rotate"></div>
              <span class="text-xs text-text-subtle">Loading...</span>
            </div>
            <div class="hidden text-xs text-text-subtle text-center absolute" id="faviconError">No image</div>
          </div>
          <div class="flex-1 flex flex-col gap-1">
            <span class="text-md text-text-primary font-normal" id="faviconLabel">Image</span>
            <span class="text-sm text-text-muted" id="faviconSizeLabel">-</span>
          </div>
        </div>
        <div id="actionButtons"></div>
      </div>

      <!-- Reset Section -->
      <div class="mt-4.5 pt-4.5 border-t border-border-light">
        <label class="block text-sm font-medium text-text-subtle mb-2.5 uppercase tracking-wider">Reset</label>
        <div class="flex gap-2.5">
          <button class="flex-1 flex items-center justify-center gap-2 bg-white/[0.05] border border-border-medium rounded-lg px-3 py-2.5 cursor-pointer transition-all duration-250 ease-bounce text-text-secondary text-sm font-medium font-mono tracking-tight hover:bg-white/[0.08] hover:border-white/25 hover:-translate-y-px" id="resetSiteBtn" title="Reset settings for this site only">
            <img id="resetSiteFavicon" class="w-4 h-4 rounded-sm object-contain" alt="" />
            <span>This Site</span>
          </button>
          <button class="flex-1 flex items-center justify-center gap-2 bg-white/[0.05] border border-accent-red/30 rounded-lg px-3 py-2.5 cursor-pointer transition-all duration-250 ease-bounce text-accent-red text-sm font-medium font-mono tracking-tight hover:bg-accent-red/15 hover:border-accent-red/50 hover:-translate-y-px" id="resetAllBtn" title="Reset all settings to default">
            <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
              <path d="M3 3v5h5" />
            </svg>
            <span>Reset All</span>
          </button>
        </div>
      </div>

      <div class="text-sm text-center text-text-secondary min-h-[18px] opacity-0 transition-opacity duration-300 ease-bounce" id="status"></div>

      </div><!-- End Settings Tab -->

      <!-- Editor Tab -->
      <div class="tab-content hidden" id="editorTab">
        <!-- Empty State -->
        <div class="editor-empty" id="editorEmpty">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="18" height="18" rx="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <path d="M21 15l-5-5L5 21" />
          </svg>
          <p>No image loaded</p>
          <p class="hint">Right-click an image and select "Edit Image"<br/>or upload an image below</p>
        </div>

        <!-- Editor Content (visible when image loaded) -->
        <div class="editor-content" id="editorContent">
          <!-- Toolbar -->
          <div class="editor-toolbar" id="editorToolbar">
            <!-- Undo/Redo -->
            <button class="editor-btn" id="editorUndo" title="Undo (Ctrl+Z)" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 7v6h6" />
                <path d="M3 13a9 9 0 1 0 3-7.5L3 7" />
              </svg>
            </button>
            <button class="editor-btn" id="editorRedo" title="Redo (Ctrl+Y)" disabled>
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 7v6h-6" />
                <path d="M21 13a9 9 0 1 1-3-7.5L21 7" />
              </svg>
            </button>

            <div class="editor-toolbar-divider"></div>

            <!-- Rotate -->
            <button class="editor-btn" id="editorRotateLeft" title="Rotate Left (90°)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M2.5 2v6h6" />
                <path d="M2.5 8a10 10 0 0 1 17.07-5.93" />
                <path d="M22 12a10 10 0 0 1-18.56 5.14" />
              </svg>
            </button>
            <button class="editor-btn" id="editorRotateRight" title="Rotate Right (90°)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21.5 2v6h-6" />
                <path d="M21.5 8a10 10 0 0 0-17.07-5.93" />
                <path d="M2 12a10 10 0 0 0 18.56 5.14" />
              </svg>
            </button>

            <div class="editor-toolbar-divider"></div>

            <!-- Flip -->
            <button class="editor-btn" id="editorFlipH" title="Flip Horizontal">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 3v18" />
                <path d="M16 7l4 5-4 5" />
                <path d="M8 7l-4 5 4 5" />
              </svg>
            </button>
            <button class="editor-btn" id="editorFlipV" title="Flip Vertical">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 12h18" />
                <path d="M7 8l5-4 5 4" />
                <path d="M7 16l5 4 5-4" />
              </svg>
            </button>

            <div class="editor-toolbar-divider"></div>

            <!-- Force shape buttons to next line -->
            <div class="editor-toolbar-break"></div>

            <!-- Shape -->
            <button class="editor-btn shape-btn" data-shape="circle" title="Circle Shape">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10" />
              </svg>
            </button>
            <button class="editor-btn shape-btn" data-shape="rounded" title="Rounded Shape">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="4" ry="4" />
              </svg>
            </button>
            <button class="editor-btn shape-btn active" data-shape="square" title="Square Shape">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" />
              </svg>
            </button>
          </div>

          <!-- Canvas Container -->
          <div class="editor-canvas-container" id="editorCanvasContainer">
            <canvas id="editorCanvas"></canvas>
            <div class="editor-loading-overlay hidden" id="editorLoading">
              <div class="flex flex-col items-center justify-center gap-3">
                <div class="spinner-circle animate-rotate"></div>
                <span class="text-sm text-text-secondary">Loading...</span>
              </div>
            </div>
            <!-- Background Color Picker -->
            <div class="absolute top-2 right-2">
              <input type="color" id="canvasBgColor" value="#1a1a1d" class="w-8 h-8 cursor-pointer rounded-lg border border-border-light bg-surface-dark/90 backdrop-blur-sm shadow-lg" title="Background color" />
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="editor-actions" id="editorActions">
            <button class="editor-action-btn primary" id="editorDownload">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7 10 12 15 17 10" />
                <line x1="12" y1="15" x2="12" y2="3" />
              </svg>
              Download
            </button>
            <button class="editor-action-btn secondary" id="editorSetDefault">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z" />
              </svg>
              Default
            </button>
            <button class="editor-action-btn secondary" id="editorApplyFavicon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 6L9 17l-5-5" />
              </svg>
              Preview
            </button>
          </div>
        </div>

        <!-- Upload in Editor -->
        <div class="mt-4 pt-4 border-t border-border-light">
          <div class="upload-zone bg-white/[0.02] border-2 border-dashed border-border-strong rounded-xl p-4 text-center cursor-pointer transition-all duration-250 relative hover:border-white/[0.35] hover:bg-white/[0.04]" id="editorUploadZone">
            <input type="file" id="editorUploadInput" accept="image/*" hidden />
            <div class="flex flex-col items-center gap-2">
              <svg class="w-6 h-6 stroke-text-subtle" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="17 8 12 3 7 8" />
                <line x1="12" y1="3" x2="12" y2="15" />
              </svg>
              <span class="text-sm text-text-secondary">Drop image or click to upload</span>
            </div>
          </div>
        </div>
      </div><!-- End Editor Tab -->

    </div>
    <script src="popup.js"></script>
  </body>
</html>
